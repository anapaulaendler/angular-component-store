<header>
  <h1>Parking Lot Control</h1>
</header>

<ng-container *ngIf="{ vm: (vm$ | async)! } as asyncData">
  
  <div class="messages">
    <p class="error" *ngIf="asyncData.vm.error">{{ asyncData.vm.error }}</p>
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <input
      type="text"
      formControlName="plate"
      placeholder="Ex: 2FMDK3, 1GYS4C, 1GKS1E, 1G6AS5"
    />
    <div *ngIf="form.get('plate')?.invalid && form.get('plate')?.touched" class="error">
      <small *ngIf="form.get('plate')?.hasError('required')">Campo obrigatório.</small>
      <small *ngIf="form.get('plate')?.hasError('minlength')">Mínimo 5 caracteres.</small>
    </div>

    <button type="submit" [disabled]="form.invalid || (vm$ | async)?.loading">Adicionar Carro</button>
  </form>

  <div class="shortcuts">
    <h5>Shortcuts</h5>
    <button type="button" (click)="addPlate('2FMDK3')">2FMDK3</button>
    <button type="button" (click)="addPlate('1GYS4C')">1GYS4C</button>
    <button type="button" (click)="addPlate('1GKS1E')">1GKS1E</button>
    <button type="button" (click)="addPlate('1G6AS5')">1G6AS5</button>
  </div>

  <app-car-list [cars]="(vm$ | async)?.cars || []"></app-car-list>
</ng-container>